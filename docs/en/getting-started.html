<html><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"/><title>Getting Started · Metro</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Getting Started · Metro"/><meta property="og:type" content="website"/><meta property="og:url" content="https://facebook.github.io/metro/index.html"/><meta property="og:description" content="Install Metro using `npm`:"/><meta property="og:image" content="/metro/img/opengraph.png"/><link rel="shortcut icon" href="/metro/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="/metro/css/main.css"/><link rel="alternate" type="application/atom+xml" href="https://facebook.github.io/blog/atom.xml" title="Metro Blog ATOM Feed"/> <link rel="alternate" type="application/rss+xml" href="https://facebook.github.io/blog/feed.xml" title="Metro Blog RSS Feed"/><script async="" defer="" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/metro/js/webplayer.js"></script><script type="text/javascript" src="https://snack.expo.io/embed.js"></script></head><body class="sideNavVisible"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/metro/"><img class="logo" src="/metro/img/metro.svg"/><h2 class="headerTitle">Metro</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li><a href="/metro/docs/en/getting-started.html" target="_self">Docs</a></li><li><a href="/metro/docs/en/api.html" target="_self">API</a></li><li><a href="/metro/en/help.html" target="_self">Help</a></li><li><a href="/metro/blog" target="_self">Blog</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search"/></li><li><a href="https://github.com/facebook/metro" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Introduction</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/metro/docs/en/getting-started.html#content">Getting Started</a></li><li class="navListItem"><a class="navItem" href="/metro/docs/en/bundling.html#content">Bundling</a></li></ul></div><div class="navGroup navGroupActive"><h3>API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/metro/docs/en/api.html#content">API</a></li><li class="navListItem"><a class="navItem" href="/metro/docs/en/configuration.html#content">Configuring Metro</a></li><li class="navListItem"><a class="navItem" href="/metro/docs/en/cli.html#content">Metro CLI Options</a></li></ul></div><div class="navGroup navGroupActive"><h3>Guides</h3><ul><li class="navListItem"><a class="navItem" href="/metro/docs/en/troubleshooting.html#content">Troubleshooting</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/facebook/metro/edit/master/docs/GettingStarted.md" target="_blank">Edit this Doc</a><h1>Getting Started</h1></header><article><div><p>Install Metro using <code>npm</code>:</p><pre class="prism language-javascript">npm install <span class="token operator">--</span>save<span class="token operator">-</span>dev metro</pre><p>Or via <a href="https://yarnpkg.com/en/package/jest" target="_blank"><code>yarn</code></a>:</p><pre class="prism language-javascript">yarn add <span class="token operator">--</span>dev metro</pre><h2><a class="anchor" name="running-metro"></a>Running <code>metro</code> <a class="hash-link" href="#running-metro">#</a></h2><p>Right now, Metro Bundler cannot run by itself. Instead, some functions are exposed so that the configuration can be passed into it. First, require the module by doing:</p><pre class="prism language-js"><span class="token keyword">const</span> metroBundler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;metro&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>Within the object returned, two main methods are given:</p><h3><a class="anchor" name="method-createserverserveroptions"></a>Method <code>createServer(serverOptions)</code> <a class="hash-link" href="#method-createserverserveroptions">#</a></h3><p>Given a set of options (same ones as the <code>build</code> method), a <code>metro-server</code> will be returned. You can then hook this into a proper HTTP(S) server by using its <code>processRequest</code> method:</p><pre class="prism language-js"><span class="token string">&#x27;use strict&#x27;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;http&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> metroBundler <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;metro&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> TerminalReporter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;metro/src/lib/TerminalReporter&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Terminal <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;metro/src/lib/Terminal&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> metroBundlerServer <span class="token operator">=</span> metroBundler<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  assetRegistryPath<span class="token punctuation">:</span> __dirname<span class="token punctuation">,</span>
  projectRoots<span class="token punctuation">:</span> <span class="token punctuation">[</span>__dirname<span class="token punctuation">]</span><span class="token punctuation">,</span>
  reporter<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">TerminalReporter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Terminal</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> httpServer <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>
  metroBundlerServer<span class="token punctuation">.</span>processRequest<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>metroBundlerServer<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

httpServer<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>In order to be also compatible with Express apps, processRequest will also call its third parameter when the request could not be handled by Metro bundler. This allows you to integrate the server with your existing server, or to extend a new one:</p><pre class="prism language-js"><span class="token keyword">const</span> httpServer <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  metroBundlerServer<span class="token punctuation">.</span><span class="token function">processRequest</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span spellcheck="true" class="token comment">// Metro does not know how to handle the request.</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><p>If you are using <a href="http://expressjs.com/" target="_blank">Express</a>, you can just pass <code>processRequest</code> as a middleware:</p><pre class="prism language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;express&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  metroBundlerServer<span class="token punctuation">.</span>processRequest<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>metroBundlerServer<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><h3><a class="anchor" name="method-buildserveroptions-bundleoptions"></a>Method <code>build(serverOptions, bundleOptions)</code> <a class="hash-link" href="#method-buildserveroptions-bundleoptions">#</a></h3><p>Given a set of options that you would typically pass to a server, plus a set of options specific to the bundle itself, a bundle will be built. The return value is a Promise that resolves to an object with two properties, <code>code</code> and <code>map</code>. This is useful at build time.</p><h2><a class="anchor" name="available-options"></a>Available options <a class="hash-link" href="#available-options">#</a></h2><h3><a class="anchor" name="possible-server-options"></a>Possible server options <a class="hash-link" href="#possible-server-options">#</a></h3><ul><li><code>assetExts (Array&lt;string&gt;)</code>: List of extensions that should be considered as assets. Assets are non-JavaScript files that can be required with a <code>require</code> call, and that the server can return back. Defaults to a sane, comprehensive list of image, video, audio, document and font formats.</li><li><code>assetRegistryPath (string)</code>: Root where to look for the assets. See <code>assetExts</code> for more information.</li><li><code>blacklistRE (RegExp)</code>: Regular expression matching files that do not have to be processed when recursively crawling the tree of dependencies from the root. Defaults to a non-matching regular expression (meaning all modules are processed).</li><li><code>cacheVersion (string)</code>: Used to invalidate caches when changes happen on the transform pipeline. By default, transformed files are cached for speed.</li><li><code>enableBabelRCLookup (boolean)</code>: True if <code>.babelrc</code> files coming from other Node modules have to be looked up or not (i.e. if their transforms have to be applied to the files contained within the module).</li><li><code>getPolyfills ((platform) =&gt; Array&lt;string&gt;)</code>: Method that returns a list of paths to polyfills to be added to the bundle. The platform (if provided) will be passed as the only argument of the method. Polyfills are guaranteed to be loaded before any code, and in the provided order in the array.</li><li><code>getTransformOptions ((mainModuleName, options, getDependenciesOf) =&gt; Promise&lt;Array&lt;string&gt;&gt;)</code>:</li><li><code>getUseGlobalHotkey (() =&gt; boolean)</code>: Method that returns whether the global hotkey should be used or not. Useful especially on Linux servers.</li><li><code>maxWorkers (number)</code>: Maximum amount of workers to use when transforming and bundling. By default it uses an amount computed using the available cores of the processor (approximately 50% of them).</li><li><code>platforms (Array&lt;string&gt;)</code>: Array of platforms supported. Currently you can pass <code>&#x27;ios&#x27;</code> and <code>&#x27;android&#x27;</code> there. This information will be used for bundle generation (both the code included and the format to be served).</li><li><code>postProcessModules ((modules, entryPoints) =&gt; Array&lt;Module&gt;)</code>: Allows to post process the list of modules, either by adding, removing or modifying the existing ones.</li><li><code>projectRoots (Array&lt;string&gt;)</code>: List of all directories to look for source files. When asking for a particular bundle, each of the roots will be examined to see if the requested file exists in one of these.</li><li><code>reporter (Reporter)</code>: a reporter instance that will be used to report progress. Various reporters are provided with Metro Bundler,</li><li><code>resetCache (boolean)</code>: Metro bundler holds an internal, persisted cache where all the transformed modules (using the provided transformer in <code>transformModulePath</code>) is stored. If the file does not change, the transformed file will be served. When passing <code>true</code> to <code>resetCache</code>, all of the cache will be thrown away.</li><li><code>silent (boolean)</code>: Whether bundling progress should be reported to the reporter given in the <code>reporter</code> option. Defaults to <code>false</code>.</li><li><code>sourceExts</code>: List of extensions that should be considered as source code. Source code files are files that will be transformed and bundled all at once. Defaults to JS and JSON extensions.</li><li><code>transformModulePath (string)</code>: Full path of the JS file that contains the transformer. Read further on the transformer section for more information. The default transformer is a no-op one: it just outputs the code as it gets input.</li></ul><h3><a class="anchor" name="possible-bundle-options"></a>Possible bundle options: <a class="hash-link" href="#possible-bundle-options">#</a></h3><ul><li><code>dev (boolean)</code>: optional boolean indicating if the bundle has to be built in development mode. Implies things like setting <code>__DEV__</code> to <code>true</code>. Defaults to <code>false</code>.</li><li><code>entryFile (string)</code>: entry point for bundling the file.</li><li><code>inlineSourceMap (boolean)</code>: indicates whether the source map is provided inlined with the bundle (as a bas64 encoded URL), or in a separate file. When provided as a separate file, the URL where it will be found can be customized with <code>sourceMapUrl</code>. Defaults to <code>false</code>.</li><li><code>minify (boolean)</code>: whether code should be minified. Defaults to <code>false</code>.</li><li><code>platform (string)</code>: if a list of platforms is provided, a particular platform can be passed.</li><li><code>sourceMapUrl (string)</code>: URL where the source map can be found. It defaults to the same same URL as the bundle, but changing the extension from <code>.bundle</code> to <code>.map</code>. When <code>inlineSourceMap</code> is <code>true</code>, this property has no effect.</li></ul><h2><a class="anchor" name="url-and-bundle-request"></a>URL and bundle request <a class="hash-link" href="#url-and-bundle-request">#</a></h2><p>The server has the ability to serve assets, bundles and source maps for those bundles.</p><h3><a class="anchor" name="assets"></a>Assets <a class="hash-link" href="#assets">#</a></h3><p>In order to request an asset, you can freely use the <code>require</code> method as if it was another JS file. The server will treat this specific <code>require</code> calls  and make them return the path to that file. When an asset is requested (an asset is recognized by its extension, which has to be on the <code>assetExts</code> array) it is generally served as-is.</p><p>However, the server is also able to serve specific assets depending on the platform and on the requested size (in the case of images). The way you specify the platform is via the dotted suffix (e.g. <code>.ios</code>) and the resolution via the at suffix (e.g. <code>@2x</code>). This is transparently handled for you when using <code>require</code>.</p><h3><a class="anchor" name="bundle"></a>Bundle <a class="hash-link" href="#bundle">#</a></h3><p>Any JS file can be used as the root for a bundle request. The file will be looked into each of the project roots provided (via the <code>projectRoots</code> property of the server). All files that are required by the root will be recursively included. In order to request a bundle, just change the extension from <code>.js</code> to <code>.bundle</code>. Options for building the bundle are passed as query parameters (all optional).</p><ul><li><code>dev</code>: build the bundle in development mode or not. Maps 1:1 to the <code>dev</code> setting of the bundles. Pass <code>true</code> or <code>false</code> as strings into the URL.</li><li><code>platform</code>: platform requesting the bundle. Can be <code>ios</code> or <code>android</code>. Maps 1:1 to the <code>platform</code> setting of the bundles.</li><li><code>minify</code>: whether code should be minified or not. Maps 1:1 to the <code>minify</code> setting of the bundles. Pass <code>true</code> or <code>false</code> as strings into the URL.</li><li><code>excludeSource</code>: whether sources should be included in the source map or not. Pass <code>true</code> or <code>false</code> as strings into the URL.</li></ul><p>For instance, requesting <code>http://localhost:8081/foo/bar/baz.bundle?dev=true&amp;platform=ios</code> will create a bundle out of <code>foo/bar/baz.js</code> for iOS in development mode.</p><h3><a class="anchor" name="source-maps"></a>Source maps <a class="hash-link" href="#source-maps">#</a></h3><p>Source maps are built for each bundle by using the same URL as the bundle (thus, the same as the JS file acting as a root). This will only work when <code>inlineSourceMap</code> is set to <code>false</code>. All options you passed to the bundle will be added to the source map URL; otherwise, they wouldn&#x27;t match.</p><h2><a class="anchor" name="javascript-transformer"></a>JavaScript transformer <a class="hash-link" href="#javascript-transformer">#</a></h2><p>The JavaScript transformer (<code>transformModulePath</code>) is the place where JS code will be manipulated; useful for calling Babel. The transformer can export two methods:</p><h3><a class="anchor" name="method-transformmodule"></a>Method <code>transform(module)</code> <a class="hash-link" href="#method-transformmodule">#</a></h3><p>Mandatory method that will transform code. The object received has information about the module being transformed (e.g its path, code...) and the returned object has to contain an <code>ast</code> key that is the AST representation of the transformed code. The default shipped transformer does the bare minimum amount of work by just parsing the code to AST:</p><pre class="prism language-js"><span class="token keyword">const</span> babylon <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;babylon&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token punctuation">(</span>file<span class="token punctuation">:</span> <span class="token punctuation">{</span>filename<span class="token punctuation">:</span> string<span class="token punctuation">,</span> src<span class="token punctuation">:</span> string<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> ast <span class="token operator">=</span> babylon<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>code<span class="token punctuation">,</span> <span class="token punctuation">{</span>sourceType<span class="token punctuation">:</span> <span class="token string">&#x27;module&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>ast<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></pre><p>If you would like to plug-in babel, you can simply do that by passing the code to it:</p><pre class="prism language-js"><span class="token keyword">const</span> <span class="token punctuation">{</span>transform<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;babel-core&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>transform <span class="token operator">=</span> file <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">transform</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>src<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span spellcheck="true" class="token comment">// Babel options...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre><h3><a class="anchor" name="method-getcachekey"></a>Method <code>getCacheKey()</code> <a class="hash-link" href="#method-getcachekey">#</a></h3><p>Optional method that returns the cache key of the transformer. When using different transformers, this allows to correctly tie a transformed file to the transformer that converted it. The result of the method has to be a <code>string</code>.</p></div></article></div><div class="docs-prevnext"><a class="docs-next button" href="bundling.html#content">Next →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/metro/" class="nav-home"><img src="/metro/img/metro.svg" alt="Metro" width="66" height="58"/></a><div><h5>Docs</h5><a href="/metro/docs/en/getting-started.html">Getting Started</a><a href="/metro/docs/en/api.html">API Reference</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/metrojs" target="_blank">Stack Overflow</a><a href="https://twitter.com/MetroBundler" target="_blank">Twitter</a></div><div><h5>More</h5><a href="/metro/blog">Blog</a><a href="https://github.com/facebook/metro">GitHub</a><a class="github-button" href="https://github.com/facebook/metro" data-icon="octicon-star" data-count-href="/facebook/metro/stargazers" data-count-api="/repos/facebook/metro#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource"><img src="/metro/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2018 Facebook Inc.</section></footer></div><script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-44373548-17', 'auto');
              ga('send', 'pageview');
            </script><script>
              var search = docsearch({
                apiKey: '0cf53e80b4f3b371219cdcaa6b62e08b',
                indexName: 'metro',
                inputSelector: '#search_input_react'
              });
            </script></body></html>